{
  "_id": "{{@ system @}}",
  "authentication": "basic",
  "operations": {
    "identities-delete": {
      "method": "DELETE",
      "url": "users/{{ entity['$source']['user_id'] }}/identities/{{ entity['$source']['id'] }}"
    },
    "identities-insert": {
      "method": "POST",
      "payload_property": "identity",
      "url": "users/{{ entity['$source']['user_id'] }}/identities.json"
    },
    "identities-list": {
      "method": "GET",
      "next_page_link": "{{ body.links.next }}",
      "next_page_termination_strategy": [
        "empty-result",
        "next-page-link-empty"
      ],
      "params": {
        "page[size]": 1
      },
      "payload_property": "identities",
      "url": "users/{{ properties.user_id }}/identities"
    },
    "identities-lookup": {
      "method": "GET",
      "payload_property": "identity",
      "url": "users/{{ entity['$source']['user_id'] }}/identities/{{ entity['$source']['id'] }}"
    },
    "identities-update": {
      "method": "PUT",
      "payload_property": "identity",
      "url": "users/{{ entity['$source']['user_id'] }}/identities/{{ entity['$source']['id'] }}"
    },
    "organizations-delete": {
      "method": "DELETE",
      "url": "organizations/{{ entity['$source']['id'] }}.json"
    },
    "organizations-insert": {
      "method": "POST",
      "payload_property": "organization",
      "url": "organizations.json"
    },
    "organizations-list": {
      "id_expression": "{{ id }}",
      "method": "GET",
      "next_page_link": "{{ body.links.next }}",
      "next_page_termination_strategy": [
        "empty-result",
        "next-page-link-empty"
      ],
      "params": {
        "page[size]": 1
      },
      "payload_property": "organizations",
      "url": "organizations"
    },
    "organizations-lookup": {
      "method": "GET",
      "payload_property": "organization",
      "url": "organizations/{{ entity['$source']['id'] }}.json"
    },
    "organizations-update": {
      "method": "PUT",
      "payload_property": "organization",
      "url": "organizations/{{ entity['$source']['id'] }}.json"
    },
    "ticketcomments-list": {
      "method": "GET",
      "next_page_link": "{{ body.links.next }}",
      "next_page_termination_strategy": [
        "empty-result",
        "next-page-link-empty"
      ],
      "params": {
        "page[size]": 1
      },
      "payload_property": "comments",
      "url": "tickets/{{ properties.ticket_id }}/comments"
    },
    "tickets-delete": {
      "method": "DELETE",
      "url": "tickets/{{ entity['$source']['id'] }}.json"
    },
    "tickets-insert": {
      "method": "POST",
      "payload_property": "ticket",
      "url": "tickets.json"
    },
    "tickets-list": {
      "id_expression": "{{ id }}",
      "method": "GET",
      "next_page_link": "{{ body.links.next }}",
      "next_page_termination_strategy": [
        "empty-result",
        "next-page-link-empty"
      ],
      "params": {
        "page[size]": 1
      },
      "payload_property": "tickets",
      "url": "tickets.json"
    },
    "tickets-lookup": {
      "method": "GET",
      "payload_property": "ticket",
      "url": "tickets/{{ entity['$source']['id'] }}.json"
    },
    "tickets-update": {
      "method": "PUT",
      "payload_property": "ticket",
      "url": "tickets/{{ entity['$source']['id'] }}.json"
    },
    "users-delete": {
      "method": "DELETE",
      "url": "users/{{ entity['$source']['id'] }}"
    },
    "users-insert": {
      "method": "POST",
      "payload_property": "user",
      "url": "users.json"
    },
    "users-list": {
      "id_expression": "{{ id }}",
      "method": "GET",
      "next_page_link": "{{ body.links.next }}",
      "next_page_termination_strategy": [
        "empty-result",
        "next-page-link-empty"
      ],
      "params": {
        "page[size]": 1
      },
      "payload_property": "users",
      "url": "users"
    },
    "users-lookup": {
      "method": "GET",
      "payload_property": "user",
      "url": "users/{{ entity['$source']['id'] }}"
    },
    "users-update": {
      "method": "PUT",
      "payload_property": "user",
      "url": "users/{{ entity['$source']['id'] }}"
    }
  },
  "password": "$SECRET(api_key)",
  "type": "system:rest",
  "url_pattern": "https://{{@ subdomain @}}.zendesk.com/api/v2/%s",
  "username": "{{@ email @}}/token",
  "verify_ssl": true
}